---
nginx:
  security_headers_default:
    - header: "X-Frame-Options"
      value: "SAMEORIGIN"
      always: yes
    - header: "X-Content-Type-Options"
      value: "nosniff"
      always: yes
    - header: "X-XSS-Protection"
      value: "1; mode=block"
      always: yes
    - header: "Referrer-Policy"
      value: "no-referrer-when-downgrade"
      always: yes
    - header: "Content-Security-Policy"
      value: "frame-ancestors 'self'"
      always: yes
    - header: "Strict-Transport-Security"
      value: >-
        {% if hsts %}
        max-age={{ hsts.max_age }}
        include-subdomains={{ hsts.include_subdomains }}
        preload={{ hsts.preload }}
        {% endif %}
      always: yes
nginx_security_headers_merged: "{{ nginx['security_headers_default'] | community.general.lists_mergeby(nginx['security_headers'], 'header') }}"
